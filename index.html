<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Ar viewer</title>
    <link rel="stylesheet" href="style.css">
    <script type="module" src="https://ajax.googleapis.com/ajax/libs/model-viewer/3.0.0/model-viewer.min.js"></script>
</head>
<body>

    <!-- Upload model -->
    <label for="file-upload" class="custom-file-upload">
        <i class="fa fa-cloud-upload"></i> Custom Upload
    </label>
    <input id="file-upload" type="file"/>

    <!-- Show model -->
    <model-viewer src="./glb/Chair.glb" ar ar-modes="webxr scene-viewer quick-look" camera-controls poster="poster.webp" shadow-intensity="1" render-scale="1" camera-orbit="-60deg auto 100%" 
    field-of-view='7deg' max-field-of-view='30deg'>
        <div class="progress-bar hide" slot="progress-bar">
            <div class="update-bar"></div>
        </div>

        <!-- Choose model -->
        <div class="slider">
            <div class="slides">
              <button class="slide selected" onclick="switchSrc(this, 'Chair')" style="background-image: url('./slider/Chair.webp');"></button>
              
              <button class="slide" onclick="switchSrc(this, 'Mixer')" style="background-image: url('./slider/Mixer.webp');"></button>
              
              <button class="slide" onclick="switchSrc(this, 'GeoPlanter')" style="background-image: url('./slider/GeoPlanter.webp');"></button>
              
              
              <button class="slide" onclick="switchSrc(this, 'ToyTrain')" style="background-image: url('./slider/ToyTrain.webp');"></button>
              
              </button><button class="slide" onclick="switchSrc(this, 'Canoe')" style="background-image: url('./slider/Canoe.webp');"></button>  
            </button></div>
          </div>
    </model-viewer>
    <script>
          
        // Show model
        const modelViewer = document.querySelector("model-viewer");

        // Upload model
        window.addEventListener('load', function() {
            document.querySelector('input[type="file"]').addEventListener('change', function() {
                if (this.files && this.files[0]) {
                    modelViewer.onload = () => {
                        URL.revokeObjectURL(modelViewer.src);  // no longer needed, free memory
                    }

                    modelViewer.src = URL.createObjectURL(this.files[0]); // set src to blob url
                }
            });
        });
        // Size model
        modelViewer.style.width = "100%"
        modelViewer.style.height = "100vh"

        // Choose model
        window.switchSrc = (element, name) => {
        modelViewer.src = `/glb/${name}.glb`
        modelViewer.poster = `/slider/${name}.webp`;
        const slides = document.querySelectorAll(".slide");
        slides.forEach((element) => {element.classList.remove("selected");});
        element.classList.add("selected");
        };

        document.querySelector(".slider").addEventListener('beforexrselect', (ev) => {
        // Keep slider interactions from affecting the XR scene.
        ev.preventDefault();
        });
    </script>
</body>
</html>